CMAKE_MINIMUM_REQUIRED(VERSION 2.6.0)
PROJECT(venom C)

LIST(APPEND CMAKE_MODULE_PATH ${CMAKE_SOURCE_DIR}/cmake/vala)

INCLUDE(FindVala)
INCLUDE(${VALA_USE_FILE})

FIND_PACKAGE(Vala "0.20.0" REQUIRED)

FIND_PACKAGE(PkgConfig)
PKG_CHECK_MODULES(GTK REQUIRED gtk+-3.0)
PKG_CHECK_MODULES(GEE REQUIRED gee-1.0)
PKG_CHECK_MODULES(GIO REQUIRED gio-2.0)
ADD_DEFINITIONS(${GTK_CFLAGS} ${GTK_CFLAGS_OTHER})
ADD_DEFINITIONS(${GEE_CFLAGS} ${GEE_CFLAGS_OTHER})
ADD_DEFINITIONS(${GIO_CFLAGS} ${GIO_CFLAGS_OTHER})
LINK_LIBRARIES(toxcore ${GTK_LIBRARIES} ${GEE_LIBRARIES} ${GIO_LIBRARIES})
LINK_DIRECTORIES(${GTK_LIBRARY_DIRS} ${GEE_LIBRARY_DIRS} ${GIO_LIBRARY_DIRS})

vala_precompile( VALA_C_TEST
  testing/ToxVapiTest.vala
PACKAGES
  gio-2.0
OPTIONS
#--debug
#--save-temps
CUSTOM_VAPIS
  vapi/tox.vapi
GENERATE_VAPI
GENERATE_HEADER
)

vala_precompile( VALA_C
  Venom/AddFriendDialog.vala
  Venom/Contact.vala
  Venom/ContactList.vala
  Venom/DhtServer.vala
  Venom/Main.vala
  Venom/ToxSession.vala
PACKAGES
  gee-1.0
  gtk+-3.0
  glib-2.0
  gio-2.0
OPTIONS
#  --debug
#  --save-temps
CUSTOM_VAPIS
  vapi/tox.vapi
GENERATE_VAPI
GENERATE_HEADER
)

ADD_EXECUTABLE( venom
  ${VALA_C}
)

ADD_EXECUTABLE( vapi_test
  ${VALA_C_TEST}
)

# vim:set ts=2 sw=2 et:
